{% extends "portal/base.html" %}

{% load static %}

{% load humanize %}

{% block title %} Editar operación {% endblock title %}

{% block content %}

{% for item in op_bill.items %}
    {{item}}
{% endfor %}

<div class="form-group col col-md-5 mx-auto">
    <form method="post">
        {% csrf_token %}

        {% for field in form %}
        <p class="fieldWrapper">
            {% if 'Original' in field.label_tag %}
                {{ field.errors }}
                {{ field.label_tag }} {{ field }}
            {% elif 'Operaciones' not in field.label_tag %}
                {{ field.errors }}
                {{ field.label_tag }} {{ field }}
                {% if field.help_text %}
                    <p class="help">{{ field.help_text|safe }}</p>
                {% endif %}
            {% endif %}
        </p>
    {% endfor %}

    <br><br>

        <p class="fieldWrapper">
            {% if form.ops.value %}
                {{ form.ops.errors }}
                <label for="{{ form.ops.id_for_label }}">Operación asociada:</label>
                {{ form.ops }}
            {% else %}
                {% if op_bill.type == 'expense' %}
                    {% if bill_card_ops_num > 0 %}
                        {{ form.ops.errors }}
                        <label for="{{ form.ops.id_for_label }}">Operaciones del período sin equivalencia:</label>
                        {{ form.ops }}
                    {% else %}
                        <label for="{{ form.ops.id_for_label }}">Problema:</label>
                        <p class="alert alert-danger">Este cargo no fue informado al momento de la transacción.</p>
                    {% endif %}
                {% endif %}
            {% endif %}
        </p>

        <br>

        <input
            class="btn btn-secondary me-1"
            value="Actualizar"
            type="submit">
        <input
            class="btn btn-secondary me-1"
            value="Cancelar"
            type="button"
            onclick="location.href='javascript:history.go(-1)'">
        <input
            class="btn btn-secondary me-1"
            value="&#128270; Maps"
            type="button"
            onclick="window.open('https://timeline.google.com/maps/timeline?pb=!1m2!1m1!1s{{ object.date_string }}','_blank')">
    </form>
</div>

{% endblock %}